{{ block title }}
    Key-Press Task
{{ endblock }}

{{ block content }}
<link rel="stylesheet" type="text/css" href="{{ static 'global/task.css' }}"/>

<div id = "earnings_information">
    <div id = "earnings_information_left" >
          <div id = "next_key_to_press_text">
                To earn, please press:
          </div>
          <div id = "next_key_to_press_box">
                <p id ="next_key_to_press">Z</p>
          </div>
    </div>
    <input type="hidden" name="num_key_pairs" id="num_key_pairs" />
    <div id = "num_key_pairs_box" >
      Total number of pairs in this round: <p id = "score"></p>
    </div>
</div>

{{ next_button }}


<script>
let buffer = [];
let keys = [];
let series = [];
let total = 0;

let lastKeyTime = Date.now();
document.addEventListener("keydown", function (event) {
  const charList = '90,88';
  const key = event.key.toLowerCase();
  keys.push( event.keyCode );
  console.log(keys);

  if (event.keyCode == 90) {
    document.getElementById("next_key_to_press").innerHTML = "X";
  } else {
    console.log('Z was not pressed');
  }

  if (event.keyCode == 88) {
    document.getElementById("next_key_to_press").innerHTML = "Z";
  } else {
    console.log('X was not pressed');
  }


  if (keys.toString().indexOf( charList ) >= 0 ) {
    console.log("You pressed the correct sequence" );
    buffer.push(key);
    keys = [];
    series.push("1")
    total = total + 1;
    document.getElementById("num_key_pairs").value = total;
    document.getElementById("score").innerHTML = total;

  } else {
  console.log('no match');
  }

  const currentTime = Date.now();

if (currentTime - lastKeyTime > 500) {
    buffer = [];
  }

  lastKeyTime = currentTime;
  console.log(buffer);
  console.log(series);
});
  </script>


{{ endblock }}